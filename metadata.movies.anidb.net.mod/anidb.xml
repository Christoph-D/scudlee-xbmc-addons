<?xml version="1.0" encoding="utf-8"?>
<scraper framework="1.1" date="2011-04-18">

  <GetDetails clearbuffers="no" dest="3">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
      <RegExp input="$$1" output="\1" dest="20">
        <expression clear="yes">(?i)&lt;anime\s+id=&quot;(\d+)&quot;</expression>
      </RegExp>
      <RegExp conditional="PersonalAnimeMapping" input="" output="&lt;url function=&quot;GetPersonalAnimeMapping&quot; cache=&quot;pers-anime-list.xml&quot;&gt;$INFO[PersonalAnimeMappingUrl]&lt;/url&gt;" dest="8">
        <expression/>
      </RegExp>
      <RegExp input="" output="&lt;url function=&quot;LoadAnimeMapping&quot; cache=&quot;anime-list.xml&quot;&gt;$INFO[AnimeMappingUrl]&lt;/url&gt;" dest="8+">
        <expression/>
      </RegExp>
      <RegExp input="" output="&lt;chain function=&quot;GetIDByIDChain&quot;&gt;$$20&lt;/chain&gt;" dest="8+">
        <expression/>
      </RegExp>
      <RegExp input="" output="&lt;chain function=&quot;GetTitleByIDChain&quot;&gt;$$20&lt;/chain&gt;" dest="8+">
        <expression/>
      </RegExp>
      <RegExp input="" output="&lt;chain function=&quot;GetOriginalTitleByIDChain&quot;&gt;$$20&lt;/chain&gt;" dest="8+">
        <expression/>
      </RegExp>
      <RegExp input="" output="&lt;chain function=&quot;GetStartDateByIDChain&quot;&gt;$$20&lt;/chain&gt;" dest="8+">
        <expression/>
      </RegExp>
      <RegExp conditional="UseTags" input="" output="&lt;chain function=&quot;GetTagsByIDChain&quot;&gt;$$20&lt;/chain&gt;" dest="8+">
        <expression/>
      </RegExp>
      <RegExp input="" output="&lt;chain function=&quot;GetRatingByIDChain&quot;&gt;$$20&lt;/chain&gt;" dest="8+">
        <expression/>
      </RegExp>
      <RegExp input="" output="&lt;chain function=&quot;GetGenresByIDChain&quot;&gt;$$20&lt;/chain&gt;" dest="8+">
        <expression/>
      </RegExp>
      <RegExp input="" output="&lt;chain function=&quot;GetPlotByIDChain&quot;&gt;$$20&lt;/chain&gt;" dest="8+">
        <expression/>
      </RegExp>
      <RegExp input="" output="&lt;chain function=&quot;GetCastByIDChain&quot;&gt;$$20&lt;/chain&gt;" dest="8+">
        <expression/>
      </RegExp>
      <RegExp input="" output="&lt;chain function=&quot;GetWritersByIDChain&quot;&gt;$$20&lt;/chain&gt;" dest="8+">
        <expression/>
      </RegExp>
      <RegExp input="" output="&lt;chain function=&quot;GetDirectorsByIDChain&quot;&gt;$$20&lt;/chain&gt;" dest="8+">
        <expression/>
      </RegExp>
      <RegExp input="" output="&lt;chain function=&quot;GetStudiosByIDChain&quot;&gt;$$20&lt;/chain&gt;" dest="8+">
        <expression/>
      </RegExp>
      <RegExp input="" output="&lt;chain function=&quot;GetArtworkByIDChain&quot;&gt;$$20&lt;/chain&gt;" dest="8+">
        <expression/>
      </RegExp>
      <RegExp conditional="UseSets" input="" output="&lt;chain function=&quot;GetTMDBSetByIDChain&quot;&gt;$$20&lt;/chain&gt;" dest="8+">
        <expression/>
      </RegExp>
      <RegExp input="$$1" output="&lt;id&gt;$$20&lt;/id&gt;&lt;plot&gt;### YOU ARE BANNED FROM ANIDB.NET ###\nWAIT SOME TIME UNTIL YOU ARE UNBANNED&lt;/plot&gt;&lt;episodeguide&gt;&lt;url gzip=&quot;yes&quot; cache=&quot;$$2.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=$$2&lt;/url&gt;&lt;/episodeguide&gt;" dest="8">
        <expression>(?i)&lt;error&gt;banned&lt;/error&gt;</expression>
      </RegExp>
      <RegExp input="$$20" output="&lt;chain function=&quot;StartDelayLoop&quot;&gt;&amp;&lt;/chain&gt;" dest="8+">
        <expression noclean="1"/> 
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </GetDetails>

  <GetTMDBSetByIDChain clearbuffers="no" dest="3">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
      <RegExp input="$$12" output="&lt;url function=&quot;ParseTMDBSet&quot; cache=&quot;tmdb-$$20-\1.json&quot;&gt;http://api.themoviedb.org/3/movie/\1?api_key=57983e31fb435df4df77afb854740ea9&lt;/url&gt;" dest="8">
        <expression>((?:tt)?\d+)</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </GetTMDBSetByIDChain>
  <ParseTMDBSet clearbuffers="no" dest="4">
    <RegExp input="$$2" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp input="$$1" output="&lt;set&gt;\1&lt;/set&gt;" dest="2">
        <expression clear="yes" noclean="1">&quot;belongs_to_collection&quot;:\{&quot;id&quot;:[0-9]+,&quot;name&quot;:&quot;([^&quot;]*)</expression>
      </RegExp>
      <expression clear="yes" noclean="1" />
    </RegExp>
  </ParseTMDBSet>

  <StartDelayLoop clearbuffers="no" dest="3">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;details&gt;" dest="3">
      <RegExp input="" output="`X" dest="11">
        <expression/> 
      </RegExp>
      <RegExp input="" output="&lt;chain function=&quot;DelayLoop&quot;&gt;&amp;&lt;/chain&gt;" dest="8">
        <expression/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </StartDelayLoop>  
  <DelayLoop clearbuffers="no" dest="4">
    <RegExp input="$$4" output="&lt;details&gt;\1&lt;details&gt;" dest="4">
      <RegExp input="$$11" output="&lt;chain function=&quot;DelayLoop&quot;&gt;&amp;&lt;/chain&gt;" dest="4">
        <RegExp input="$$10" output="\1" dest="11">
          <RegExp input="$$11" output="\1`X" dest="10">
            <expression>^((?:`(?!.*Z)){1,$INFO[DelayValue]}?)X$</expression> 
          </RegExp> 
          <RegExp input="$$11" output="\1Y" dest="10">
            <expression>^((?:`(?!.*Z)){$INFO[DelayValue]})`X$</expression> 
          </RegExp> 
          <RegExp input="$$11" output="\1Y" dest="10">
            <expression>^((?:`(?!.*Z)){1,$INFO[DelayValue]}?)`Y$</expression> 
          </RegExp> 
          <expression />
        </RegExp>
        <expression clear="yes">``+</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </DelayLoop>

</scraper>